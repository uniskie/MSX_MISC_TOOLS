1000 COLOR 15,0,0:VDP(9)=VDP(9)AND253
1010 CLEAR 200,&HB000:DEFINT A-Z
1020 DIM P(255),X(3,8),Y(3,8),A(3),W(3),AP(3,9),AF(3)
1030 SCREEN7:DEFUSR=&H156
1040 BLOAD"LOADSRD.BOF":DEFUSR1=&HD000:DEFUSR2=&HD003:DEFUSR3=&HD006
1050 F$="JENE-ANI"
1060 COPY F$+".PL7" TO P
1065 FOR I=0TO7:P(I*16)=33:NEXT
1070 PN=0:GOSUB 2230
1080 SCREEN,3:BLOAD"TIME.SPR",S,&H7800
1090 SETPAGE0,1:A$=USR1(F$+".SR7"):SETPAGE0,0
1004 '
1110 FOR I=0TO3
1120  READ X(I,0),Y(I,0)
1130  FOR J=1 TO 8
1140   READ X(I,J),Y(I,J)
1150  NEXT
1160  READ A$,B$
1170  FOR J=0 TO 9
1180   AP(I,J)=VAL(MID$(A$,J+1,1))
1190  NEXT
1200 NEXT
1210 '     SIZE     ORG     ANIME1,2,3,4,5,6,7(X,Y)
1220 DATA  40,26,   96,40,  342,40,  96,40,   0,0, 0,0, 0,0, 0,0, 0,0
1230 DATA "11212.....",EYE
1240 DATA  90,24,   81,68,  327,67,  327,68, 81,68,   0,0, 0,0, 0,0, 0,0
1250 DATA "1231223...",BUST
1260 DATA 114,88,  110,96,  356,96,  110,96,  0,0, 0,0, 0,0, 0,0, 0,0
1270 DATA "122.......",LEG
1280 DATA   0,0 ,    0, 0,  0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0
1290 DATA "..........",HAND
1300 '
1310 FOR I=0 TO 7:PUTSPRITE I,(128+I*16,0),6,15:COLORSPRITE$(I)=STRING$(4,15)+STRING$(4,5):NEXT
1320 'µÔ¼Þ É »ÞË®³
1330 KX=80:KY=116
1340 PUTSPRITE 9,(KX,KY),13,12
1350 PUTSPRITE 8,(KX,KY),7,13
1360 PUTSPRITE 31,(KX,KY+2),15,14
1370 O1=52:O2=48:MF=56
1380 ONINTERVAL=30 GOSUB 2100:GOSUB 2100
1381 '
1382 A$="t80l8s0m20000o5 ge-o4b-o5e- fb-4. fgfo4b-o5e-2"
1383 B$="t80l8v13o4 r4g4o5d4.o4f b-4 b-4 sm20000g2"
1384 PLAY A$,B$
1385 '
1390 'ºËß° »· É »ÞË®³
1400 OX=0:OY=0
1410 COPY (0,0)-(311,211),1 TO (OX,OY),0
1420 GETTIME T$:EF=-(VAL(MID$(T$,5,1))AND1)
1430 'VDP(26)=2
1440 '
1450 'MAIN LOOP
1460 'VS=(VS-1)AND255:VDP(27)=VS\8:VDP(28)=255-VS
1470 I$=INKEY$:A=USR(0)
1480 IF I$=" " THEN GOSUB 2180
1490 IF I$<>CHR$(13) THEN 1510
1500 O1=60+(O1=60)*8:O2=60+(O2=60)*12:VPOKE -1502,O1:VPOKE -1498,O2
1510 IF I$<>CHR$(11) THEN 1530
1520 MF=60+(MF=60)*4:VPOKE -1410,MF
1530 ' (ANIMATION)
1540 VPOKE -1412,KY+TF+TF+2
1550 VPOKE -1504,KY+TF+TF
1560 VPOKE -1500,KY+TF+TF
1570 EB=EF
1580 GET TIME T$
1590 EF=-(VAL(MID$(T$,5,1))AND1)
1600 IF (EB<>EF) AND EF THEN GOSUB2180 'ÊßÚ¯Ä +1
1610 A=2:GOSUB 1900
1620 A=1:GOSUB 1800
1630 A=0:GOSUB 1700
1640 'A=3:GOSUB 1300
1650 GOTO 1450
1660 '-------MAIN END
1670 ' COPY
1680 COPY (X(A,P+1),Y(A,P+1))-STEP(X(A,0),Y(A,0)),1 TO (X(A,1)+OX,Y(A,1)+OY),0
1690 RETURN
1700 'EYES
1710 IF W(A) AND (EF=EB) THEN W(A)=W(A)-1:RETURN
1720 P=AP(A,A(A)+1+EF)
1730 GOSUB 1680
1740 A(A)=A(A)+1
1750 IF A(A)<(5-EF) THEN 1770
1760 A(A)=0:W(A)=RND(3)*(10-EF*16)
1770 RETURN
1780 '
1790 '
1800 'BUST
1810 IF (EF=0) AND (EF=EF) THEN A(A)=3-A(2):W(A)=0
1820 IF W(A) THEN W(A)=W(A)-1:RETURN
1830 P=AP(A,A(A))
1840 GOSUB 1680
1850 A(A)=A(A)+1
1860 IF (A(A)<4) AND EF THEN RETURN
1870 A(A)=0:W(A)=RND(3)*30
1880 RETURN
1890 '
1900 'LEG
1910 IF W(A) AND (EF=EB) THEN W(A)=W(A)-1:RETURN
1920 P=AP(A,A(A))
1930 GOSUB 1680
1940 IF A(A)<>2 THEN 1960
1950 IF EF THEN W(A)=RND(3)*3
1960 A(A)=A(A)+1
1970 IF A(A)<(3-EF-EF-EF) THEN 1990
1980 A(A)=0
1990 RETURN
2000 'HAND
2010 IF W(A) AND (EF=EB) THEN W(A)=W(A)-1:RETURN
2020 P=AP(A,A(A))
2030 GOSUB 1680
2040 A(A)=A(A)+1
2050 IF A(A)<2 THEN 2070
2060 A(A)=0:W(A)=RND(3)*(6-EF*14)
2070 RETURN
2080 '
2090 '
2100 'TIMER
2110 INTERVAL OFF
2120 U=USR3(0) 'TIME SPRITE
2130 TF=(TF+1)AND3
2140 INTERVAL ON
2150 RETURN
2160 '
2170 '
2180 'PALETTE +1
2190 PN=(PN+1)AND7
2200 GOTO 2230
2210 '
2220 '
2230 'PALETTE (PN=PALETTE NO)
2240 PJ=PN*16
2250 U=USR2(VARPTR(P(PJ)))
2260 RETURN

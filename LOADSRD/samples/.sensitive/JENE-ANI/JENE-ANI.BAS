1000 COLOR 15,0,0:VDP(9)=VDP(9)AND253
1010 '
1020 CLEAR 200,&HB000:DEFINT A-Z
1030 DIM P(255),X(3,8),Y(3,8),A(3),W(3),AP(3,9),AF(3)
1040 SCREEN7:DEFUSR=&H156
1050 BLOAD"LOADSRD.BOF":DEFUSR1=&HD000:DEFUSR2=&HD003:DEFUSR3=&HD006
1060 F$="JENE-ANI"
1070 COPY F$+".PL7" TO P
1080 FOR I=0TO7:P(I*16)=33:NEXT
1090 PN=0:GOSUB 2320
1100 SCREEN,3:BLOAD"TIME.SPR",S,&H7800
1110 SETPAGE0,1:A$=USR1(F$+".SR7"):SETPAGE0,0
1120 FOR I=0TO3
1130  READ X(I,0),Y(I,0)
1140  FOR J=1 TO 8
1150   READ X(I,J),Y(I,J)
1160  NEXT
1170  READ A$,B$
1180  FOR J=0 TO 9
1190   AP(I,J)=VAL(MID$(A$,J+1,1))
1200  NEXT
1210 NEXT
1220 '     SIZE     ORG     ANIME1,2,3,4,5,6,7(X,Y)
1230 DATA  40,26,   96,40,  342,40,  96,40,   0,0, 0,0, 0,0, 0,0, 0,0
1240 DATA "11212.....",EYE
1250 DATA  90,24,   81,68,  327,67,  327,68, 81,68,   0,0, 0,0, 0,0, 0,0
1260 DATA "1231223...",BUST
1270 DATA 114,88,  110,96,  356,96,  110,96,  0,0, 0,0, 0,0, 0,0, 0,0
1280 DATA "122.......",LEG
1290 DATA   0,0 ,    0, 0,  0,0, 0,0, 0,0, 0,0, 0,0, 0,0, 0,0
1300 DATA "..........",HAND
1310 '
1320 FOR I=0 TO 7:PUTSPRITE I,(128+I*16,0),6,15:COLORSPRITE$(I)=STRING$(4,15)+STRING$(4,5):NEXT
1330 'µÔ¼Þ É »ÞË®³
1340 KX=80:KY=116
1350 PUTSPRITE 9,(KX,KY),13,12
1360 PUTSPRITE 8,(KX,KY),7,13
1370 PUTSPRITE 31,(KX,KY+2),15,14
1380 O1=52:O2=48:MF=56
1390 '
1400 ONINTERVAL=4 GOSUB 2180:GOSUB 2180
1410 '
1420 A$="t80l8s0m20000o5 ge-o4b-o5e- fb-4. fgfo4b-o5e-2"
1430 B$="t80l8v13o4 r4g4o5d4.o4f b-4 b-4 sm20000g2"
1440 PLAY A$,B$
1450 '
1460 'ºËß° »· É »ÞË®³
1470 OX=0:OY=0
1480 COPY (0,0)-(311,211),1 TO (OX,OY),0
1490 TM=TC:EF=((TM AND 16)>0)
1500 'VDP(26)=2
1510 '
1520 'MAIN LOOP
1530 'VS=(VS-1)AND255:VDP(27)=VS\8:VDP(28)=255-VS
1540 I$=INKEY$:A=USR(0)
1550 IF I$=" " THEN GOSUB 2270
1560 IF I$<>CHR$(13) THEN 1580
1570 O1=60+(O1=60)*8:O2=60+(O2=60)*12:VPOKE -1502,O1:VPOKE -1498,O2
1580 IF I$<>CHR$(11) THEN 1600
1590 MF=60+(MF=60)*4:VPOKE -1410,MF
1600 ' (ANIMATION)
1610 VPOKE -1412,KY+TF+TF+2
1620 VPOKE -1504,KY+TF+TF
1630 VPOKE -1500,KY+TF+TF
1640 EB=TM
1650 TM=TC:EF=((TM AND 16)>0)
1660 IF EB=TM THEN 1630
1670 IF EF THEN GOSUB2270 'ÊßÚ¯Ä +1
1680 A=2:GOSUB 1980
1690 A=1:GOSUB 1880
1700 A=0:GOSUB 1780
1710 'A=3:GOSUB 1300
1720 GOTO 1520
1730 '-------MAIN END
1740 ' COPY
1750 COPY (X(A,P+1),Y(A,P+1))-STEP(X(A,0),Y(A,0)),1 TO (X(A,1)+OX,Y(A,1)+OY),0
1760 RETURN
1770 '
1780 'EYES
1790 IF W(A)>0 THEN W(A)=W(A)-1:RETURN
1800 P=AP(A,A(A))'AP(A,A(A)+1+EF)
1810 GOSUB 1750
1820 A(A)=A(A)+1
1830 IF A(A)<(5-EF) THEN 1850
1840 A(A)=0:W(A)=RND(3)*(10-EF*16)
1850 RETURN
1860 '
1870 '
1880 'BUST
1890 IF (EF=0) THEN A(A)=3-A(2):W(A)=0
1900 IF W(A) THEN W(A)=W(A)-1:RETURN
1910 P=AP(A,A(A))
1920 GOSUB 1750
1930 A(A)=A(A)+1
1940 IF (A(A)<4) AND EF THEN RETURN
1950 A(A)=0:W(A)=RND(3)*30
1960 RETURN
1970 '
1980 'LEG
1990 IF W(A) THEN W(A)=W(A)-1:RETURN
2000 P=AP(A,A(A))
2010 GOSUB 1750
2020 IF A(A)<>2 THEN 2040
2030 IF EF THEN W(A)=RND(3)*3
2040 A(A)=A(A)+1
2050 IF A(A)<(3-EF-EF-EF) THEN 2070
2060 A(A)=0
2070 RETURN
2080 'HAND
2090 IF W(A) THEN W(A)=W(A)-1:RETURN
2100 P=AP(A,A(A))
2110 GOSUB 1750
2120 A(A)=A(A)+1
2130 IF A(A)<2 THEN 2150
2140 A(A)=0:W(A)=RND(3)*(6-EF*14)
2150 RETURN
2160 '
2170 '
2180 'TIMER
2190 INTERVAL OFF
2200 TC=(TC+1)AND 255:IF TC AND 3 GOTO 2230
2210 U=USR3(0) 'TIME SPRITE
2220 TF=(TF+1)AND3
2230 INTERVAL ON
2240 RETURN
2250 '
2260 '
2270 'PALETTE +1
2280 PN=(PN+1)AND7
2290 GOTO 2320
2300 '
2310 '
2320 'PALETTE (PN=PALETTE NO)
2330 PJ=PN*16
2340 U=USR2(VARPTR(P(PJ)))
2350 RETURN

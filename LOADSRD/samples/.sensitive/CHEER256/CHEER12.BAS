1000 COLOR 15,0,0:VDP(9)=VDP(9)AND253
1010 '
1020 CLEAR 200,&HB000:DEFINT A-Z
1030 DIM F$(10),P(256),A(8),V(2,2):PG=0:SG=1:VF=0:VM=255-212:SC=12
1040 SCREEN SC,,,,,0:DEFUSR=&H156
1050 BLOAD"SRX.BIN":DEFUSR1=&HD000:DEFUSR2=&HD003:DEFUSR3=&HD006
1060 F$="CHEER256":E$=".SR"+HEX$(SC)
1070 COPY F$+".PL7" TO P
1080 FOR I=0TO7:P(I*16)=33:NEXT
1090 PN=0:GOSUB 1780
1100 '
1110 GOSUB 1980:GOSUB 1850:SCREEN,3:CLS
1120 A=VARPTR(A(0)):POKEA,PEEK(&HF928):POKEA+1,PEEK(&HF929):FOR I=0 TO 7:A(I)=A(0)+I*4:NEXT
1130 FORI=0TO127:VPOKEA(0)+I,0:NEXT:FORI=1TO512:VPOKEA(0)-I,0:NEXT
1140 A$=STRING$(0,16):FORI=0TO31:PUTSPRITE I,((I*32)AND 255,(I\8)*32),0,0:COLORSPRITE$(I)=A$:NEXT
1150 '
1160 ' CLOCK
1170 BLOAD"TIME.SPR",S,&H7800
1180 CX=132:CY=152
1190 FOR I=0 TO 7:PUTSPRITE I,(CX+I*15,CY),5,15:COLORSPRITE$(I)=STRING$(4,7)+STRING$(4,6):NEXT
1200 '
1210 GOSUB 1910:A$=USR1(F$+E$):GOSUB 1850
1220 'SCREEN,2:BLOAD"TIME.SPR",S,&H7800
1230 '
1240 '*µÔ¼Þ É »ÞË®³
1250 KX=132:KY=98:P0=4:P1=8:P2=12
1260 PUTSPRITE 9,(KX,KY),13,15-P2\4
1270 PUTSPRITE 8,(KX,KY),1 ,15-P1\4
1280 PUTSPRITE 31,(KX,KY+2),15,15-P0\4
1290 O1=52:O2=48:MF=56
1300 TD=8:TV=TD:TF=0
1310 '
1320 ONINTERVAL=3 GOSUB 1650:GOSUB 1650
1330 '
1340 A$="t80l8s0m20000o5 ge-o4b-o5e- fb-4. fgfo4b-o5e-2"
1350 B$="t80l8v13o4 r4g4o5d4.o4f b-4 b-4 sm20000g2"
1360 PLAY A$,B$
1370 '
1380 GOSUB 1850
1390 TM=TC:EF=((TM AND 16)>0)
1400 VL=0:VDP(24)=VL:VD=18:VV=VD:VP=0
1410 '
1420 '*MAIN LOOP
1430 'VS=(VS-1)AND255:VDP(27)=VS\8:VDP(28)=255-VS
1440 I$=INKEY$:A=USR(0)
1450 IF I$=" " THEN GOSUB 1730
1460 IF I$<>CHR$(13) THEN 1480
1470 O1=60+(O1=60)*P1:O2=60+(O2=60)*P2:VPOKE -1502,O1:VPOKE -1498,O2
1480 IF I$<>CHR$(11) THEN 1500
1490 MF=60+(MF=60)*P0:VPOKE -1410,MF
1500 '*(ANIMATION)
1510 TF=TF-TV:TV=TV-1:IF TV=-TD THEN TV=-TV:TF=TF+TV
1520 VPOKE -1412,KY+TF+2
1530 VPOKE -1504,KY+TF
1540 VPOKE -1500,KY+TF
1550 EB=TM
1560 TM=TC:EF=((TM AND 16)>0)
1570 IF EB=TM THEN 1540
1580 IF EF THEN GOSUB 1730 'ÊßÚ¯Ä +1
1590 VP=VP+VV:VV=VV-1:IF VV=-VD THEN VV=-VV:VP=VP-VV
1600 VL=VP\4:VDP(24)=VL AND 255
1610 A=(CY+VL)AND 255:FOR I=0 TO 7:VPOKE A(I),A+(A=216):NEXT
1620 GOTO 1420
1630 '-------MAIN END
1640 '
1650 '*TIMER
1660 INTERVAL OFF
1670 TC=(TC+1)AND 255:IF TC AND 3 GOTO 1690
1680 U=USR3(0) 'TIME SPRITE
1690 INTERVAL ON
1700 RETURN
1710 '
1720 '
1730 '*PALETTE +1
1740 PN=(PN+1)AND 7
1750 GOTO 1780
1760 '
1770 '
1780 '*SET PALETTE (PN=PALETTE NO)
1790 PJ=PN*16
1800 U=USR2(VARPTR(P(PJ)))
1810 RETURN
1820 '
1830 '
1840 '*SETPAGE PG,1-PG
1850 SETPAGE PG,1-PG
1860 'spr table »²¾¯Ã²¶ÞËÂÖ³
1870 VDP(12)=V(SG,0) 'SPR ATTR TBL
1880 VDP(6)=V(SG,1) 'SPR PATGEN TBL
1890 RETURN
1900 '
1910 '*SETPAGE PG,PG
1920 SETPAGE PG,PG
1930 'spr table »²¾¯Ã²¶ÞËÂÖ³
1940 VDP(12)=V(SG,0) 'SPR ATTR TBL
1950 VDP(6)=V(SG,1) 'SPR PATGEN TBL
1960 RETURN
1970 '
1980 '*CALC SPR ADR REG
1990 V(0,0)=VDP(12)AND 253 'PAGE 0:SPR ATTR TBL
2000 V(0,1)=VDP(6)AND 223  'PAGE 0:SPR PATGEN TBL
2010 V(1,0)=VDP(12)OR 2  'PAGE 1:SPR ATTR TBL
2020 V(1,1)=VDP(6)OR 32  'PAGE 1:SPR PATGEN TBL
2030 RETURN


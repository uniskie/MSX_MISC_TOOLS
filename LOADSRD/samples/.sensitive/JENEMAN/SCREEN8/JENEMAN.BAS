1000 COLOR 15,0,0:VDP(9)=VDP(9)AND253
1010 '
1020 CLEAR 200,&HB000:DEFINT A-Z
1030 DIM F$(10),P(256),A(8),V(2,2):PG=0:SG=1:VF=0:VM=255-212:SC=8
1040 SCREEN SC,,,,,0:DEFUSR=&H156
1050 BLOAD"LOADSRD.BOF":DEFUSR1=&HD000:DEFUSR2=&HD003:DEFUSR3=&HD006
1060 F$="JENEMAN":E$=".SR"+HEX$(SC)
1070 COPY F$+".PL7" TO P
1080 FOR I=0TO7:P(I*16)=33:NEXT
1090 PN=0:GOSUB 1840
1100 '
1110 GOSUB 2040:GOSUB 1910:SCREEN,3:CLS
1120 A=VARPTR(A(0)):POKEA,PEEK(&HF928):POKEA+1,PEEK(&HF929):FOR I=0 TO 7:A(I)=A(0)+I*4:NEXT
1130 'FORI=0TO127:VPOKEA(0)+I,0:NEXT:FORI=1TO512:VPOKEA(0)-I,0:NEXT
1140 A$=STRING$(0,16):FORI=0TO31:PUTSPRITE I,((I*32)AND 255,(I\8)*32),0,0:COLORSPRITE$(I)=A$:NEXT
1150 BLOAD"TIME.SPR",S,&H7800
1160 CX=132:CY=4:FOR I=0 TO 7:PUTSPRITE I,(CX+I*15,CY),12,15:COLORSPRITE$(I)=STRING$(4,11)+STRING$(4,14):NEXT
1170 '
1180 PC=9:FOR I=0TO PC-1:READ A$:F$(I)=LEFT$(A$+SPACE$(8),8):NEXT
1190 DATA "3","4","ST5","ST6","US3","US3M","US4","US4M","MR4M","MR4"
1200 GOSUB 1970:A$=USR1(F$(CR)+E$):GOSUB 1910
1210 'SCREEN,2:BLOAD"TIME.SPR",S,&H7800
1220 '
1230 '*µÔ¼Þ É »ÞË®³
1240 KX=107:KY=152:P0=4:P1=8:P2=12
1250 PUTSPRITE 9,(KX,KY),14,15-P2\4
1260 PUTSPRITE 8,(KX,KY),5 ,15-P1\4
1270 PUTSPRITE 31,(KX,KY+2),15,15-P0\4
1280 O1=52:O2=48:MF=56
1290 '
1300 ONINTERVAL=2 GOSUB 1700:GOSUB 1700
1310 '
1320 A$="t80l8s0m20000o5 ge-o4b-o5e- fb-4. fgfo4b-o5e-2"
1330 B$="t80l8v13o4 r4g4o5d4.o4f b-4 b-4 sm20000g2"
1340 PLAY A$,B$
1350 '
1360 GOSUB 1910
1370 TM=TC:EF=((TM AND 16)>0)
1380 VL=0:VDP(24)=VL:VV=-1
1390 '
1400 '*MAIN LOOP
1410 'VS=(VS-1)AND255:VDP(27)=VS\8:VDP(28)=255-VS
1420 I$=INKEY$:A=USR(0)
1430 IF I$=" " THEN GOSUB 1790
1440 IF I$<>CHR$(13) THEN 1460
1450 O1=60+(O1=60)*P1:O2=60+(O2=60)*P2:VPOKE -1502,O1:VPOKE -1498,O2
1460 IF I$<>CHR$(11) THEN 1480
1470 MF=60+(MF=60)*P0:VPOKE -1410,MF
1480 '*(ANIMATION)
1490 VPOKE -1412,KY+TF+TF+2
1500 VPOKE -1504,KY+TF+TF
1510 VPOKE -1500,KY+TF+TF
1520 EB=TM
1530 TM=TC:EF=((TM AND 16)>0)
1540 IF EB=TM THEN 1510
1550 IF EF THEN GOSUB 1790 'ÊßÚ¯Ä +1
1560 VL=VL+VV
1570 A=VL+VF:IF(A>=0)AND(A<=VM) THEN 1590
1580 VV=-VV:VL=-VF-A*(A>VM) 'VL=0 or VM
1590 VDP(24)=VL AND 255
1600 A=(CY+VL)AND 255:FOR I=0 TO 7:VPOKE A(I),A+(A=216):NEXT
1610 IF RND(3)*100 < 1 THEN GOSUB 1650
1620 GOTO 1400
1630 '-------MAIN END
1640 '
1650 '*LOAD
1660 CR=RND(2)*PC
1670 GOSUB 1970:A$=USR1(F$(CR)+E$):GOSUB 1910
1680 RETURN
1690 '
1700 '*TIMER
1710 INTERVAL OFF
1720 TC=(TC+1)AND 255:IF TC AND 7 GOTO 1750
1730 U=USR3(0) 'TIME SPRITE
1740 TF=(TF+1)AND 3
1750 INTERVAL ON
1760 RETURN
1770 '
1780 '
1790 '*PALETTE +1
1800 PN=(PN+1)AND 7
1810 GOTO 1840
1820 '
1830 '
1840 '*SET PALETTE (PN=PALETTE NO)
1850 PJ=PN*16
1860 U=USR2(VARPTR(P(PJ)))
1870 RETURN
1880 '
1890 '
1900 '*SETPAGE PG,1-PG
1910 SETPAGE PG,1-PG
1920 'spr table »²¾¯Ã²¶ÞËÂÖ³
1930 VDP(12)=V(SG,0) 'SPR ATTR TBL
1940 VDP(6)=V(SG,1) 'SPR PATGEN TBL
1950 RETURN
1960 '
1970 '*SETPAGE PG,PG
1980 SETPAGE PG,PG
1990 'spr table »²¾¯Ã²¶ÞËÂÖ³
2000 VDP(12)=V(SG,0) 'SPR ATTR TBL
2010 VDP(6)=V(SG,1) 'SPR PATGEN TBL
2020 RETURN
2030 '
2040 '*CALC SPR ADR REG
2050 V(0,0)=VDP(12)AND 253 'PAGE 0:SPR ATTR TBL
2060 V(0,1)=VDP(6)AND 223  'PAGE 0:SPR PATGEN TBL
2070 V(1,0)=VDP(12)OR 2  'PAGE 1:SPR ATTR TBL
2080 V(1,1)=VDP(6)OR 32  'PAGE 1:SPR PATGEN TBL
2090 RETURN

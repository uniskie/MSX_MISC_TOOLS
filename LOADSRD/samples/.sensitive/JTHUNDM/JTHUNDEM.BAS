1000 CLEAR 200,&HB000:DEFINT A-Z
1010 DIM P(255),W(3),LF(64):HT=0:LF=1:W(0)=0
1020 '
1030 F$="JTHUNDEM.SR7"
1040 '
1050 E$=LEFT$(RIGHT$(F$,3),2)
1060 SR=(E$="SR")OR(E$="sr")'OR(E$="Sr")OR(E$="sR")
1070 '
1080 COLOR 15,0,0:VDP(9)=VDP(9)AND253
1090 SCREEN7:DEFUSR=&H156
1100 BLOAD"LOADSRD.BOF":DEFUSR1=&HD000:DEFUSR2=&HD003:DEFUSR3=&HD006
1110 SCREEN,3:BLOAD"TIME.SPR",S,&H7800
1120 '
1130 IF SR THEN COPY F$+".PL7" TO P:PN=0:GOSUB 1800
1140 SETPAGE0,1:A$=USR1(F$+".SR7"):SETPAGE0,0
1150 IF SR=0 THEN SETPAGE,1:COLOR=RESTORE:SETPAGE,0
1160 '
1170 'Ä¹² É Ë®³¼Þ
1180 CX=128:CY=1
1190 FOR I=0 TO 7:PUTSPRITE I,(CX+I*16,CY),2,15:COLORSPRITE$(I)=STRING$(4,4)+STRING$(4,3):NEXT
1200 '
1210 'µÔ¼Þ É Ë®³¼Þ
1220 KX=34:KY=124
1230 PUTSPRITE 9,(KX,KY),13,12
1240 PUTSPRITE 8,(KX,KY),7,13
1250 PUTSPRITE 31,(KX,KY+2),15,14
1260 O1=52:O2=48:MF=56
1270 '
1280 ONINTERVAL=4 GOSUB 1680:GOSUB 1680
1290 '
1300 'ÎÝÀ² Ë®³¼Þ
1310 OX=0:OY=0:OW=251:OH=212:SX=0:SY=0:EX=SX+OW-1:EY=SY+OH-1
1320 'COPY (SX,SY)-(EX,EY),1 TO (OX,OY),0
1330 TM=TC:EF=((TM AND 16)>0)
1340 'VDP(26)=2
1350 '
1360 'MAIN LOOP
1370 'VS=(VS-1)AND255:VDP(27)=VS\8:VDP(28)=255-VS
1380 I$=INKEY$:A=USR(0)
1390 IF I$=CHR$(9) THEN W(0)=0
1400 IF I$=" " THEN GOSUB 1760
1410 IF I$<>CHR$(13) THEN 1430
1420 O1=60+(O1=60)*8:O2=60+(O2=60)*12:VPOKE -1502,O1:VPOKE -1498,O2
1430 IF I$<>CHR$(11) THEN 1450
1440 MF=60+(MF=60)*4:VPOKE -1410,MF
1450 ' (ANIMATION)
1460 VPOKE -1412,KY+TF+TF+2
1470 VPOKE -1504,KY+TF+TF
1480 VPOKE -1500,KY+TF+TF
1490 TB=TM
1500 TM=TC:EF=((TM AND 16)>0)
1510 IF TB=TM THEN 1360
1520 IF EF THEN GOSUB1760 'ÊßÚ¯Ä +1
1530 A=0:GOSUB 1570
1540 GOTO 1360
1550 '-------MAIN END
1560 '
1570 'FADE IN
1580 IF W(A) THEN W(A)=W(A)-1:RETURN
1590 LM=64:L=12:LI=LN
1600 LI=-LI*(LI<LM):IF (LF(LI)=LF) AND (L>0) THEN L=L-1:LI=LI+1:GOTO 1600
1610 IF LF(LI)=LF THEN LN=LI:GOTO 1640 ELSE LN=RND(4)*LM
1620 HT=HT+1:LF(LI)=LF:FW=OW\8:FH=OH/8:FX=(LI AND 7)*FW:FY=(LI\8)*FH:AX=SX+FX:AY=SY+FY
1630 COPY(AX,AY)-(AX+FW,AY+FH),1TO(OX+FX,OY+FY),0
1640 W(A)=0'3+RND(3)
1650 IF HT>=LM THEN HT=0:LF=1-LF:SX=511-EX-SX:W(A)=150+RND(3)*300
1660 RETURN
1670 '
1680 'TIMER
1690 INTERVAL OFF
1700 TC=(TC+1)AND 255:IF TC AND 3 THEN 1730
1710 U=USR3(0) 'TIME SPRITE
1720 TF=(TF+1)AND3
1730 INTERVAL ON
1740 RETURN
1750 '
1760 'PALETTE +1
1770 PN=(PN+1)AND7
1780 GOTO 1800
1790 '
1800 'PALETTE (PN=PALETTE NO)
1810 IF SR=0 THEN RETURN
1820 PJ=PN*16:U=USR2(VARPTR(P(PJ)))
1830 RETURN

1000 CLEAR1500,&HB000:DEFINTA-Z:DIM PL(255),SC$(63)
1010 COLOR15,0,0:SCREEN5,3
1020 SETPAGE,1:BLOAD"KUONAI.SC5",S:COLOR=RESTORE:SETPAGE,0
1030 BLOAD"KUONAI.SPR",S:OPEN"KUONAI.SPC"FOR INPUT AS#1:FOR I=0 TO 63:SC$(I)=INPUT$(16,#1):NEXT:CLOSE #1
1040 FOR I=1 TO 63 STEP 2:FOR J=1TO LEN(SC$(I)):MID$(SC$(I),J,1)=CHR$(ASC(MID$(SC$(I),J,1)) OR 64):NEXT:NEXT ' not collision
1050 OPEN"GRP:"AS#1:ON INTERVAL=60 GOSUB 3000:INTERVAL ON:CT=0
1060 I=RND(-TIME):FOR I=0 TO 3:X(I)=RND(3)*224:Y(I)=180:VX(I)=1+RND(3)*8:VY(I)=-(8+RND(1)*10):S(I)=INT(RND(3)*16)*2:SO(I)=1:NEXT
1070 J=0:FOR I=0 TO 3
1080  IF (RND(3)*10<-1) THEN:S(I)=(S(I)+2)AND 63:SO(I)=1
1090  X(I)=X(I)+VX(I):IF(X(I)>224)OR(X(I)<0)THEN VX(I)=-VX(I):X(I)=X(I)+VX(I)
1100  Y(I)=Y(I)+VY(I):IF(Y(I)>180)THEN Y(I)=180:VY(I)=-(8+RND(1)*10)
1110  VY(I)=VY(I)+1
1120  GOSUB 2000:J=J+2
1130 NEXT
1140 CT=CT+1:GOTO 1070
1990 '
2000 ON SO(I) GOTO 2040
2010 PUTSPRITE J,(X(I),Y(I)):PUTSPRITE J+1,(X(I),Y(I)):RETURN
2040 PUTSPRITE J,(X(I),Y(I)),,S(I):PUTSPRITE J+1,(X(I),Y(I)),,S(I)+1
2060 COLORSPRITE$(J)=SC$(S(I)):COLORSPRITE$(J+1)=SC$(S(I)+1):SO(I)=0
2090 RETURN
2990 '
3000 PSET(120,120),0:PRINT #1,RIGHT$(HEX$(256+CT),2)
3010 CT=0:RETURN

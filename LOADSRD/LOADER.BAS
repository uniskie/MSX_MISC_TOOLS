100 CLEAR200,&HB000:DEFINTA-Z:DIMP(255)
110 P=1:SD=7:ID=0:ED$="SC"
120 BLOAD"LOADSRD.BOF":DEFUSR=&HD000
130 '
140 FILES:PRINT:LINEINPUT"file=";A$
150 E$="":IF A$="" THEN 140
160 I=INSTR(A$,"."):IF I=0 THEN 180
170 E$=LEFT$(MID$(A$,I+1),3):A$=LEFT$(A$,I-1)
180 IF E$="" THEN E$=MID$(A$,9)
190 F$=LEFT$(A$+SPACE$(8),8):GOSUB 300
200 GOSUB 500:SCREEN 0,,,,,0:GOTO 140
210 '
300 '-- KoMoji to OhMoji --
310 IF LEN(E$)<1 THEN 340
320 FORI=1TOLEN(E$):A=ASC(MID$(E$,I,1)):A=A+((A>96)AND(A<123))*32:MID$(E$,I,1)=CHR$(A):NEXT
330 '
340 '-- CHECK EXTENSION --
350 RESTORE
360 READ A$,I,L:IF A$=E$ THEN 380
370 IF A$<>"" THEN 360 ELSE 390
380 IF A$<>"" THEN SC=I:IL=L:EX$=A$:RETURN
390 SC=SD:IL=ID:EX$=ED$+HEX$(SC):RETURN
400 '
410 DATA"SR5",5,0,"SC5",5,0,"SR7",7,0,"SC7",7,0,"SR8",8,0,"SC8",8,0,"SRA",10,0,"S10",10,0,"SRC",12,0,"S12",12,0
420 DATA"S50",5,3,"S51",5,3,"S70",7,3,"S71",7,3,"S80",8,3,"S81",8,3,"SA0",10,3,"SA1",10,3,"SC0",12,3,"SC1",12,3
430 DATA "",0,0
440 '
500 '-- LOAD SCREEN--
510 SCREEN SC,,,,,IL:IF IL=0 THEN 550
520 SETPAGE 1,0:A$=USR(F$+LEFT$(EX$,2)+"0")
530 SETPAGE 1,1:A$=USR(F$+LEFT$(EX$,2)+"1")
540 GOTO 560
550 SETPAGE P,P:A$=USR(F$+EX$)
560 IF(MID$(SE$,1,2)="SR")AND(SC<8)THEN 600
570 COLOR=RESTORE:I$=INPUT$(1):RETURN
580 '
600 '--LOAD PALETTE--
610 COPY F$+".PL"+HEX$(SC) TO P
620 J=PN*16:FORI=0 TO 15
630  COLOR=(I,(P(J)/16)AND15,P(J)AND15,P(J)/256)
640 J=J+1:NEXT:I$=INPUT$(1)
650 IF I$=CHR$(29) THEN PN=(PN-1)AND7:GOTO620
660 IF I$=CHR$(28) THEN PN=(PN+1)AND7:GOTO620
670 RETURN

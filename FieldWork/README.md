MSX2 SHIFT-JIS TEXT EDITOR  
[ FIELD WORK ] ver. 0.83  
(C) 1996,2023 UNKOSOFT

![](img/FieldWork.png)

Disk image: [fw.dsk](fw.dsk)

# 取扱説明書 

## 起動

RUN"FW.BAS"で起動。

[SHIFT+ESC]でBASICに戻ります。

BASICに戻ったら[F1]キーで
起動時のHIMEM値が出ます。

例) CLEAR200,&HE518

## 特徴

1. 要MSX2以上
2. 要漢字BASIC(MSX-JE)
3. ﾊﾞｰｼﾞｮﾝｱｯﾌﾟｱﾀﾞﾌﾟﾀｰ非対応
4. ｽｸﾘｰﾝ2使用で高速動作
5. 表示文字数は半角32x12
6. BASICから起動、BASICに復帰
   (VRAMに一時退避/復帰)

## 注意事項

- このエディターはRAMをディスクワークエリアぎりぎりまで使います。
  KANJI命令や、_MUSIC命令のようにフリーエリアを大きく消費するものとは共存できません。

- H.SYNC、スクロール機能、２１２ライン表示を使用しているため、MSX2以上が必要となっています。

- クリップボード機能はありません。

## キー操作

| キー         | 別入力 | 動作                     |
|--------------|--------|--------------------------|
| [ESC]        | CTRL+[ | メニュー表示／キャンセル |
| [SHIFT+ESC]  |        | エディタを終了           |
|--------------|--------|--------------------------|
| [SELECT]     | CTRL+X | MSX-JEのON/OFF           |
|--------------|--------|--------------------------|
| [INS]        | CTRL+R | 挿入/上書き切り替え      |
| [DEL]        |        | カーソル位置の１文字削除 |
| [BS]         | CTRL+H | カーソル手前の１文字削除 |
| [CTRL+E]     |        | カーソルより右を削除     |
|--------------|--------|--------------------------|
| [HOME]       | CTRL+K | 先頭ページを表示         |
| [SHIFT+HOME] | CTRL+L | 最終ページを表示         |
| [CTRL+上]    |        | 前のページを表示         |
| [CTRL+下]    |        | 次のページを表示         |
| [CTRL+左]    |        | 行頭へ移動               |
| [CTRL+右]    |        | 行末へ移動               |
| [CTRL+G]     |        | 指定行へ移動             |

## メニュー

| キー  |  動作        |
|-------|--------------|
| [L]   | LOAD FILE    |
| [S]   | SAVE FILE    |
| [N]   | RENAME FILE  |
| [D]   | DELETE FILE  |
| [H]   | HELP         |
| [ESC] | キャンセル   |

- helpはプログラムサイズ削減のため消去

- ファイル名入力時に
  ファイル名無しで[RETURN]キーで
  ファイル一覧から選択可能

## MSX-JE 入力時操作

| キー          | 動作                         |
|---------------|------------------------------|
| [SPACE]       | 変換・次候補                 |
| [SHIFT+SPACE] | 前候補                       |
| [F1]          | ローマ字・英数切替           |
| [F2]          | 全角カタカナ変換             |
| [F3]          | 半角カタカナ変換             |
| [F4]          | (数字4文字+F4) JISコード変換 |
| [F5][RETURN]  | 確定                         |
| [かな]        | ローマ字・かな切替           |


# STB CODE

MSX-JE
STB (Screen image Text Block)  functions

STBはMSX-JEが入力処理中の表示をするために使用するテキストデータです。
アプリケーションはこれを処理して、入力中表示をする必要があります。

| データ   | 意味                                                                               |
|----------|------------------------------------------------------------------------------------|
| 通常文字 | カーソル位置に文字を表示し、カーソルを文字幅分だけ進めます。                       |
| NULL(0)  | テキストの終わりです。                                                             |
| ^E ( 5)  | カーソル位置以降の文字を消去。カーソル位置は変化なし。                             |
| ^H ( 8)  | カーソルを1文字後退し、カーソル位置以降の文字を消去します。                        |
| ^L (12)  | カーソルをウィンドウの先頭に移動し、カーソル位置以降の文字を消去します。           |
| ^R (18)  | カーソル位置から次の1バイトで指定される長さだけ、ウィンドウの領域をリバースします。|
| ^W (23)  | 次の1バイトで指定されるウィンドウを開きます。                                      |
| ^X (24)  | 次の1バイトをX座標としてカーソルを移動します。                                     |
| ^Y (25)  | 次の1バイトをY座標としてカーソルを移動します。                                     |
| ^Z (26)  | アトリビュート指定です。次の1バイトの上位4ビットが文字色、下位4ビットが背景色です。|

| データ                   | 意味                                                           |
|--------------------------|----------------------------------------------------------------|
| 上記以外で00～15のコード | システム予約です。スキップして下さい。                         |
| 上記以外で16～31のコード | システム予約です。このコードと続く1バイトもスキップして下さい。|

# BUILD

## アセンブラ

1. tniasm v0.45  
	http://www.tni.nl/products/tniasm.html

2. sjasmplus  
	https://github.com/z00m128/sjasmplus  
	sjasmplus v1.20.3  
	https://github.com/z00m128/sjasmplus/releases/tag/v1.20.3

自分の場合、asMSX → tniasm → sjasmplusで移行しています。

> sjasmplusは基本的にtniasmのコードが通りますが、ファイル系のディレクティブが3つほど違うので、そちらの互換のためのマクロ宣言が```sjasm_preamble.asm```です。

## 準備

1. SRCフォルダかパスの通ったフォルダに```tniasm.exe```または```sjamplus.exe```を配置

## アセンブル

1. コマンドライン```cmd.exe```を起動
2. （SRCフォルダにカレントパスを移動）  
   コマンドラインに  
   ```cd "ソースファイルのあるフォルダ"```
3. tniasmの場合、コマンドラインに  
   ```_tniasm FW.ASM```
   
   sjasmplusの場合、コマンドラインに  
   ```_sjasm FW.ASM```

で、ASM.BIN が出力されます。

## 利用について

ソースコード含め、改変・再配布はご自由にどうぞ。

ただし、サポート・保証などはございません。

このプログラムを使用して起きた問題については補償いたしかねますので、
ファイル・ディスクは常にバックアップを取って使用してください。

## 参考

sjamplusでtniasm向けのソースをビルドする  
https://specnext.dev/blog/2020/11/13/migration-of-msx-project-from-tniasm-to-sjasmplus/

